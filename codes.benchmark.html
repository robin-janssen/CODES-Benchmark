
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>codes.benchmark package &#8212; CODES  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'codes.benchmark';</script>
    <link rel="icon" href="_static/favicon-96x96.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">CODES  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Quick Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/robin-janssen/CODES-Benchmark" title="CODES GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">CODES GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://codes-docs.web.app" title="CODES Docs" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="_static/favicon-96x96.png" class="icon-link-image" alt="CODES Docs"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://arxiv.org/abs/2410.20886" title="CODES Paper" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-file-alt fa-lg" aria-hidden="true"></i>
            <span class="sr-only">CODES Paper</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="docs/source/codes.benchmark.html">codes.benchmark</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="docs/source/codes.benchmark.bench_fcts.html">codes.benchmark.bench_fcts</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs/source/codes.benchmark.bench_plots.html">codes.benchmark.bench_plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs/source/codes.benchmark.bench_utils.html">codes.benchmark.bench_utils</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="docs/source/codes.surrogates.html">codes.surrogates</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="docs/source/codes.surrogates.AbstractSurrogate.html">codes.surrogates.AbstractSurrogate</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="docs/source/codes.surrogates.AbstractSurrogate.abstract_config.html">codes.surrogates.AbstractSurrogate.abstract_config</a></li>
<li class="toctree-l3"><a class="reference internal" href="docs/source/codes.surrogates.AbstractSurrogate.abstract_surrogate.html">codes.surrogates.AbstractSurrogate.abstract_surrogate</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="docs/source/codes.surrogates.surrogate_classes.html">codes.surrogates.surrogate_classes</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="docs/source/codes.train.html">codes.train</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="docs/source/codes.train.train_fcts.html">codes.train.train_fcts</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="docs/source/codes.tune.html">codes.tune</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="docs/source/codes.tune.evaluate_study.html">codes.tune.evaluate_study</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs/source/codes.tune.evaluate_tuning.html">codes.tune.evaluate_tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs/source/codes.tune.optuna_fcts.html">codes.tune.optuna_fcts</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs/source/codes.tune.postgres_fcts.html">codes.tune.postgres_fcts</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs/source/codes.tune.tune_utils.html">codes.tune.tune_utils</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="docs/source/codes.utils.html">codes.utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="docs/source/codes.utils.data_utils.html">codes.utils.data_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs/source/codes.utils.utils.html">codes.utils.utils</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/codes.benchmark.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>codes.benchmark package</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-codes.benchmark.bench_fcts">codes.benchmark.bench_fcts module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_UQ"><code class="docutils literal notranslate"><span class="pre">compare_UQ()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_batchsize"><code class="docutils literal notranslate"><span class="pre">compare_batchsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_errors"><code class="docutils literal notranslate"><span class="pre">compare_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_extrapolation"><code class="docutils literal notranslate"><span class="pre">compare_extrapolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_gradients"><code class="docutils literal notranslate"><span class="pre">compare_gradients()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_inference_time"><code class="docutils literal notranslate"><span class="pre">compare_inference_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_interpolation"><code class="docutils literal notranslate"><span class="pre">compare_interpolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_main_losses"><code class="docutils literal notranslate"><span class="pre">compare_main_losses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_models"><code class="docutils literal notranslate"><span class="pre">compare_models()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_sparse"><code class="docutils literal notranslate"><span class="pre">compare_sparse()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_UQ"><code class="docutils literal notranslate"><span class="pre">evaluate_UQ()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_accuracy"><code class="docutils literal notranslate"><span class="pre">evaluate_accuracy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_batchsize"><code class="docutils literal notranslate"><span class="pre">evaluate_batchsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_compute"><code class="docutils literal notranslate"><span class="pre">evaluate_compute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_extrapolation"><code class="docutils literal notranslate"><span class="pre">evaluate_extrapolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_gradients"><code class="docutils literal notranslate"><span class="pre">evaluate_gradients()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_interpolation"><code class="docutils literal notranslate"><span class="pre">evaluate_interpolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_iterative_predictions"><code class="docutils literal notranslate"><span class="pre">evaluate_iterative_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_sparse"><code class="docutils literal notranslate"><span class="pre">evaluate_sparse()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.run_benchmark"><code class="docutils literal notranslate"><span class="pre">run_benchmark()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.tabular_comparison"><code class="docutils literal notranslate"><span class="pre">tabular_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.time_inference"><code class="docutils literal notranslate"><span class="pre">time_inference()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-codes.benchmark.bench_plots">codes.benchmark.bench_plots module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.get_custom_palette"><code class="docutils literal notranslate"><span class="pre">get_custom_palette()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.inference_time_bar_plot"><code class="docutils literal notranslate"><span class="pre">inference_time_bar_plot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_MAE_comparison"><code class="docutils literal notranslate"><span class="pre">plot_MAE_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_all_generalization_errors"><code class="docutils literal notranslate"><span class="pre">plot_all_generalization_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_average_errors_over_time"><code class="docutils literal notranslate"><span class="pre">plot_average_errors_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_average_uncertainty_over_time"><code class="docutils literal notranslate"><span class="pre">plot_average_uncertainty_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_catastrophic_detection_curves"><code class="docutils literal notranslate"><span class="pre">plot_catastrophic_detection_curves()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_comparative_error_correlation_heatmaps"><code class="docutils literal notranslate"><span class="pre">plot_comparative_error_correlation_heatmaps()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_comparative_gradient_heatmaps"><code class="docutils literal notranslate"><span class="pre">plot_comparative_gradient_heatmaps()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_dynamic_correlation"><code class="docutils literal notranslate"><span class="pre">plot_dynamic_correlation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_error_distribution_comparative"><code class="docutils literal notranslate"><span class="pre">plot_error_distribution_comparative()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_error_distribution_per_quantity"><code class="docutils literal notranslate"><span class="pre">plot_error_distribution_per_quantity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_error_percentiles_over_time"><code class="docutils literal notranslate"><span class="pre">plot_error_percentiles_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_errors_over_time"><code class="docutils literal notranslate"><span class="pre">plot_errors_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_example_iterative_predictions"><code class="docutils literal notranslate"><span class="pre">plot_example_iterative_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_example_mode_predictions"><code class="docutils literal notranslate"><span class="pre">plot_example_mode_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_example_predictions_with_uncertainty"><code class="docutils literal notranslate"><span class="pre">plot_example_predictions_with_uncertainty()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_generalization_error_comparison"><code class="docutils literal notranslate"><span class="pre">plot_generalization_error_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_generalization_errors"><code class="docutils literal notranslate"><span class="pre">plot_generalization_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_gradients_heatmap"><code class="docutils literal notranslate"><span class="pre">plot_gradients_heatmap()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_loss_comparison"><code class="docutils literal notranslate"><span class="pre">plot_loss_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_loss_comparison_equal"><code class="docutils literal notranslate"><span class="pre">plot_loss_comparison_equal()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_loss_comparison_train_duration"><code class="docutils literal notranslate"><span class="pre">plot_loss_comparison_train_duration()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_losses"><code class="docutils literal notranslate"><span class="pre">plot_losses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_losses_dual_axis"><code class="docutils literal notranslate"><span class="pre">plot_losses_dual_axis()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_mean_deltadex_over_time_main_vs_ensemble"><code class="docutils literal notranslate"><span class="pre">plot_mean_deltadex_over_time_main_vs_ensemble()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_relative_errors"><code class="docutils literal notranslate"><span class="pre">plot_relative_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_surr_losses"><code class="docutils literal notranslate"><span class="pre">plot_surr_losses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_uncertainty_confidence"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_confidence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_uncertainty_heatmap"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_heatmap()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_uncertainty_over_time_comparison"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_over_time_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_uncertainty_vs_errors"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_vs_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.rel_errors_and_uq"><code class="docutils literal notranslate"><span class="pre">rel_errors_and_uq()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.save_plot"><code class="docutils literal notranslate"><span class="pre">save_plot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.save_plot_counter"><code class="docutils literal notranslate"><span class="pre">save_plot_counter()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-codes.benchmark.bench_utils">codes.benchmark.bench_utils module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.check_benchmark"><code class="docutils literal notranslate"><span class="pre">check_benchmark()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.check_surrogate"><code class="docutils literal notranslate"><span class="pre">check_surrogate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.clean_metrics"><code class="docutils literal notranslate"><span class="pre">clean_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.convert_dict_to_scientific_notation"><code class="docutils literal notranslate"><span class="pre">convert_dict_to_scientific_notation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.convert_to_standard_types"><code class="docutils literal notranslate"><span class="pre">convert_to_standard_types()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.count_trainable_parameters"><code class="docutils literal notranslate"><span class="pre">count_trainable_parameters()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.discard_numpy_entries"><code class="docutils literal notranslate"><span class="pre">discard_numpy_entries()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.flatten_dict"><code class="docutils literal notranslate"><span class="pre">flatten_dict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.format_seconds"><code class="docutils literal notranslate"><span class="pre">format_seconds()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.format_time"><code class="docutils literal notranslate"><span class="pre">format_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.format_value"><code class="docutils literal notranslate"><span class="pre">format_value()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.get_model_config"><code class="docutils literal notranslate"><span class="pre">get_model_config()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.get_required_models_list"><code class="docutils literal notranslate"><span class="pre">get_required_models_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.get_surrogate"><code class="docutils literal notranslate"><span class="pre">get_surrogate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.load_model"><code class="docutils literal notranslate"><span class="pre">load_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.make_comparison_csv"><code class="docutils literal notranslate"><span class="pre">make_comparison_csv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.measure_inference_time"><code class="docutils literal notranslate"><span class="pre">measure_inference_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.measure_memory_footprint"><code class="docutils literal notranslate"><span class="pre">measure_memory_footprint()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.save_table_csv"><code class="docutils literal notranslate"><span class="pre">save_table_csv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.write_metrics_to_yaml"><code class="docutils literal notranslate"><span class="pre">write_metrics_to_yaml()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-codes.benchmark">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.check_benchmark"><code class="docutils literal notranslate"><span class="pre">check_benchmark()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.check_surrogate"><code class="docutils literal notranslate"><span class="pre">check_surrogate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.clean_metrics"><code class="docutils literal notranslate"><span class="pre">clean_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_UQ"><code class="docutils literal notranslate"><span class="pre">compare_UQ()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_batchsize"><code class="docutils literal notranslate"><span class="pre">compare_batchsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_errors"><code class="docutils literal notranslate"><span class="pre">compare_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_extrapolation"><code class="docutils literal notranslate"><span class="pre">compare_extrapolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_gradients"><code class="docutils literal notranslate"><span class="pre">compare_gradients()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_inference_time"><code class="docutils literal notranslate"><span class="pre">compare_inference_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_interpolation"><code class="docutils literal notranslate"><span class="pre">compare_interpolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_main_losses"><code class="docutils literal notranslate"><span class="pre">compare_main_losses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_models"><code class="docutils literal notranslate"><span class="pre">compare_models()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_sparse"><code class="docutils literal notranslate"><span class="pre">compare_sparse()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.convert_dict_to_scientific_notation"><code class="docutils literal notranslate"><span class="pre">convert_dict_to_scientific_notation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.convert_to_standard_types"><code class="docutils literal notranslate"><span class="pre">convert_to_standard_types()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.count_trainable_parameters"><code class="docutils literal notranslate"><span class="pre">count_trainable_parameters()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.discard_numpy_entries"><code class="docutils literal notranslate"><span class="pre">discard_numpy_entries()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_UQ"><code class="docutils literal notranslate"><span class="pre">evaluate_UQ()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_accuracy"><code class="docutils literal notranslate"><span class="pre">evaluate_accuracy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_batchsize"><code class="docutils literal notranslate"><span class="pre">evaluate_batchsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_compute"><code class="docutils literal notranslate"><span class="pre">evaluate_compute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_extrapolation"><code class="docutils literal notranslate"><span class="pre">evaluate_extrapolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_gradients"><code class="docutils literal notranslate"><span class="pre">evaluate_gradients()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_interpolation"><code class="docutils literal notranslate"><span class="pre">evaluate_interpolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_sparse"><code class="docutils literal notranslate"><span class="pre">evaluate_sparse()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.flatten_dict"><code class="docutils literal notranslate"><span class="pre">flatten_dict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.format_seconds"><code class="docutils literal notranslate"><span class="pre">format_seconds()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.format_time"><code class="docutils literal notranslate"><span class="pre">format_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.format_value"><code class="docutils literal notranslate"><span class="pre">format_value()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.get_custom_palette"><code class="docutils literal notranslate"><span class="pre">get_custom_palette()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.get_model_config"><code class="docutils literal notranslate"><span class="pre">get_model_config()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.get_required_models_list"><code class="docutils literal notranslate"><span class="pre">get_required_models_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.get_surrogate"><code class="docutils literal notranslate"><span class="pre">get_surrogate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.inference_time_bar_plot"><code class="docutils literal notranslate"><span class="pre">inference_time_bar_plot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.load_model"><code class="docutils literal notranslate"><span class="pre">load_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.make_comparison_csv"><code class="docutils literal notranslate"><span class="pre">make_comparison_csv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.measure_inference_time"><code class="docutils literal notranslate"><span class="pre">measure_inference_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.measure_memory_footprint"><code class="docutils literal notranslate"><span class="pre">measure_memory_footprint()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_MAE_comparison"><code class="docutils literal notranslate"><span class="pre">plot_MAE_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_all_generalization_errors"><code class="docutils literal notranslate"><span class="pre">plot_all_generalization_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_average_errors_over_time"><code class="docutils literal notranslate"><span class="pre">plot_average_errors_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_average_uncertainty_over_time"><code class="docutils literal notranslate"><span class="pre">plot_average_uncertainty_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_comparative_error_correlation_heatmaps"><code class="docutils literal notranslate"><span class="pre">plot_comparative_error_correlation_heatmaps()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_comparative_gradient_heatmaps"><code class="docutils literal notranslate"><span class="pre">plot_comparative_gradient_heatmaps()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_dynamic_correlation"><code class="docutils literal notranslate"><span class="pre">plot_dynamic_correlation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_error_distribution_comparative"><code class="docutils literal notranslate"><span class="pre">plot_error_distribution_comparative()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_error_distribution_per_quantity"><code class="docutils literal notranslate"><span class="pre">plot_error_distribution_per_quantity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_error_percentiles_over_time"><code class="docutils literal notranslate"><span class="pre">plot_error_percentiles_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_example_iterative_predictions"><code class="docutils literal notranslate"><span class="pre">plot_example_iterative_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_example_mode_predictions"><code class="docutils literal notranslate"><span class="pre">plot_example_mode_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_example_predictions_with_uncertainty"><code class="docutils literal notranslate"><span class="pre">plot_example_predictions_with_uncertainty()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_generalization_error_comparison"><code class="docutils literal notranslate"><span class="pre">plot_generalization_error_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_generalization_errors"><code class="docutils literal notranslate"><span class="pre">plot_generalization_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_gradients_heatmap"><code class="docutils literal notranslate"><span class="pre">plot_gradients_heatmap()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_loss_comparison"><code class="docutils literal notranslate"><span class="pre">plot_loss_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_loss_comparison_train_duration"><code class="docutils literal notranslate"><span class="pre">plot_loss_comparison_train_duration()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_losses"><code class="docutils literal notranslate"><span class="pre">plot_losses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_relative_errors"><code class="docutils literal notranslate"><span class="pre">plot_relative_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_surr_losses"><code class="docutils literal notranslate"><span class="pre">plot_surr_losses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_uncertainty_confidence"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_confidence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_uncertainty_heatmap"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_heatmap()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_uncertainty_over_time_comparison"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_over_time_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_uncertainty_vs_errors"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_vs_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.read_yaml_config"><code class="docutils literal notranslate"><span class="pre">read_yaml_config()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.rel_errors_and_uq"><code class="docutils literal notranslate"><span class="pre">rel_errors_and_uq()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.run_benchmark"><code class="docutils literal notranslate"><span class="pre">run_benchmark()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.save_plot"><code class="docutils literal notranslate"><span class="pre">save_plot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.save_plot_counter"><code class="docutils literal notranslate"><span class="pre">save_plot_counter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.save_table_csv"><code class="docutils literal notranslate"><span class="pre">save_table_csv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.tabular_comparison"><code class="docutils literal notranslate"><span class="pre">tabular_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.time_inference"><code class="docutils literal notranslate"><span class="pre">time_inference()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.write_metrics_to_yaml"><code class="docutils literal notranslate"><span class="pre">write_metrics_to_yaml()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="codes-benchmark-package">
<h1>codes.benchmark package<a class="headerlink" href="#codes-benchmark-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-codes.benchmark.bench_fcts">
<span id="codes-benchmark-bench-fcts-module"></span><h2>codes.benchmark.bench_fcts module<a class="headerlink" href="#module-codes.benchmark.bench_fcts" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.compare_UQ">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">compare_UQ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.compare_UQ" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Compare log-space UQ across surrogates, focusing on:</dt><dd><ul class="simple">
<li><p>Ensemble vs Main errors (dex) over time</p></li>
<li><p>Correlation between log-space uncertainty and errors</p></li>
<li><p>Catastrophic-error detection from uncertainty thresholds</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_metrics</strong> (<em>dict</em>)  Benchmark metrics per surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.compare_batchsize">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">compare_batchsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.compare_batchsize" title="Link to this definition">#</a></dt>
<dd><p>Compare the batch size training errors of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.compare_errors">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">compare_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.compare_errors" title="Link to this definition">#</a></dt>
<dd><p>Compare relative errors and dex errors over time for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em>)  Benchmark metrics for each surrogate.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.compare_extrapolation">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">compare_extrapolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.compare_extrapolation" title="Link to this definition">#</a></dt>
<dd><p>Compare the extrapolation errors of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.compare_gradients">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">compare_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.compare_gradients" title="Link to this definition">#</a></dt>
<dd><p>Compare the gradients of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.compare_inference_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">compare_inference_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.compare_inference_time" title="Link to this definition">#</a></dt>
<dd><p>Compare the mean inference time of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>dict</em><em>]</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.compare_interpolation">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">compare_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.compare_interpolation" title="Link to this definition">#</a></dt>
<dd><p>Compare the interpolation errors of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.compare_main_losses">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">compare_main_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.compare_main_losses" title="Link to this definition">#</a></dt>
<dd><p>Compare the training and test losses of the main models for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.compare_models">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">compare_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.compare_models" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.compare_sparse">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">compare_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.compare_sparse" title="Link to this definition">#</a></dt>
<dd><p>Compare the sparse training errors of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.evaluate_UQ">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">evaluate_UQ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.evaluate_UQ" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the uncertainty quantification (UQ) performance of the surrogate model.</p>
<p>Predictions and targets are kept in log10 space (leave_log=True).
All UQ metrics are computed in log space (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  The surrogate model instance.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  DataLoader with the test data.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>optional</em>)  Labels for the predicted quantities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing log-space UQ metrics and arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.evaluate_accuracy">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">evaluate_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.evaluate_accuracy" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the accuracy of the surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Instance of the surrogate model class.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  The timesteps array.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  The DataLoader object containing the test data.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>optional</em>)  The labels for the quantities.</p></li>
<li><p><strong>percentile</strong> (<em>int</em><em>, </em><em>optional</em>)  The percentile for error metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing accuracy metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.evaluate_batchsize">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">evaluate_batchsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.evaluate_batchsize" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the batch-size scaling performance of the surrogate model in log-space (dex).</p>
<p>Predictions and targets are kept in log10 space (leave_log=True).
Errors are computed as absolute log differences (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Surrogate model instance.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  DataLoader with test data.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps array.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Batch-size scaling metrics in log-space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.evaluate_compute">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">evaluate_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.evaluate_compute" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the computational resource requirements of the surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Instance of the surrogate model class.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  The DataLoader object containing the test data.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing model complexity metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.evaluate_extrapolation">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">evaluate_extrapolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.evaluate_extrapolation" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the extrapolation performance of the surrogate model in log-space (dex).</p>
<p>Predictions and targets are kept in log10 space (leave_log=True).
Errors are computed as absolute log differences (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Surrogate model instance.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  DataLoader with test data.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps array.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>optional</em>)  Labels for the predicted quantities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extrapolation metrics in log-space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.evaluate_gradients">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">evaluate_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.evaluate_gradients" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the gradients of the surrogate model in log-space (dex).</p>
<p>Predictions and targets are kept in log10 space (leave_log=True).
Errors are computed as absolute log differences (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Surrogate model instance.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  Surrogate name.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  Test data.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>species_names</strong> (<em>list</em><em>, </em><em>optional</em>)  Names of the species/quantities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradienterror correlation metrics in log-space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.evaluate_interpolation">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">evaluate_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.evaluate_interpolation" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the interpolation performance of the surrogate model in log-space (dex).</p>
<p>Predictions and targets are kept in log10 space (leave_log=True).
Errors are computed as absolute log differences (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Surrogate model instance.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  DataLoader with test data.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps array.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>optional</em>)  Labels for the predicted quantities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolation metrics in log-space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.evaluate_iterative_predictions">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">evaluate_iterative_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.evaluate_iterative_predictions" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the iterative predictions of the surrogate model.</p>
<p>Returns the same set of error metrics as evaluate_accuracy, but over the
full trajectory built by re-feeding the last prediction as the next initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.evaluate_sparse">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">evaluate_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_train_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.evaluate_sparse" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the sparse-data training performance of the surrogate model in log-space (dex).</p>
<p>Predictions and targets are kept in log10 space (leave_log=True).
Errors are computed as absolute log differences (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Surrogate model instance.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  DataLoader with test data.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps array.</p></li>
<li><p><strong>n_train_samples</strong> (<em>int</em>)  Number of training samples in the full dataset.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sparse training metrics in log-space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.run_benchmark">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">run_benchmark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surrogate_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.run_benchmark" title="Link to this definition">#</a></dt>
<dd><p>Run benchmarks for a given surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model to benchmark.</p></li>
<li><p><strong>surrogate_class</strong>  The class of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing all relevant metrics for the given model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.tabular_comparison">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">tabular_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.tabular_comparison" title="Link to this definition">#</a></dt>
<dd><p>Compare the metrics of different surrogate models in a tabular format.
Prints a table to the CLI, saves the table into a text file, and saves a CSV file with all metrics.
Also saves a CSV file with only the metrics that appear in the CLI table.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_fcts.time_inference">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_fcts.</span></span><span class="sig-name descname"><span class="pre">time_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_test_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_fcts.time_inference" title="Link to this definition">#</a></dt>
<dd><p>Time the inference of the surrogate model (full version with metrics).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Instance of the surrogate model class.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  The DataLoader object containing the test data.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>n_test_samples</strong> (<em>int</em>)  The number of test samples.</p></li>
<li><p><strong>n_runs</strong> (<em>int</em><em>, </em><em>optional</em>)  Number of times to run the inference for timing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing timing metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-codes.benchmark.bench_plots">
<span id="codes-benchmark-bench-plots-module"></span><h2>codes.benchmark.bench_plots module<a class="headerlink" href="#module-codes.benchmark.bench_plots" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.get_custom_palette">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">get_custom_palette</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_colors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.get_custom_palette" title="Link to this definition">#</a></dt>
<dd><p>Returns a list of colors sampled from a custom color palette.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_colors</strong> (<em>int</em>)  The number of colors needed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of RGBA color tuples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.inference_time_bar_plot">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">inference_time_bar_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.inference_time_bar_plot" title="Link to this definition">#</a></dt>
<dd><p>Plot the mean inference time with standard deviation for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogates</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)  List of surrogate model names.</p></li>
<li><p><strong>means</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>)  List of mean inference times for each surrogate model.</p></li>
<li><p><strong>stds</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>)  List of standard deviation of inference times for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot. Defaults to True.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_MAE_comparison">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_MAE_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MAEs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_MAE_comparison" title="Link to this definition">#</a></dt>
<dd><p>Plot the MAE for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>MAE</strong> (<em>tuple</em>)  Tuple of accuracy arrays for each surrogate model.</p></li>
<li><p><strong>labels</strong> (<em>tuple</em>)  Tuple of labels for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_all_generalization_errors">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_all_generalization_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_all_generalization_errors" title="Link to this definition">#</a></dt>
<dd><p>Function to make one comparative plot of the interpolation, extrapolation, sparse, and batch size errors.
Only the modalities present in all_metrics will be plotted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_average_errors_over_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_average_errors_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_average_errors_over_time" title="Link to this definition">#</a></dt>
<dd><p>Plot dex errors over time for different evaluation modes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Surrogate name.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Config dictionary.</p></li>
<li><p><strong>errors</strong> (<em>np.ndarray</em>)  Errors [N_metrics, n_timesteps].</p></li>
<li><p><strong>metrics</strong> (<em>np.ndarray</em>)  Metrics [N_metrics].</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps.</p></li>
<li><p><strong>mode</strong> (<em>str</em>)  One of interpolation, extrapolation, sparse, batchsize.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_average_uncertainty_over_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_average_uncertainty_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_average_uncertainty_over_time" title="Link to this definition">#</a></dt>
<dd><p>Plot average predictive uncertainty and errors over time in log-space (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>errors_time</strong> (<em>np.ndarray</em>)  Log-space prediction errors over time.</p></li>
<li><p><strong>preds_std</strong> (<em>np.ndarray</em>)  Log-space ensemble standard deviation over time.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show a title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_catastrophic_detection_curves">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_catastrophic_detection_curves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">errors_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(99.0,</span> <span class="pre">90.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_fractions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.01,</span> <span class="pre">0.05,</span> <span class="pre">0.1,</span> <span class="pre">0.2,</span> <span class="pre">0.3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_catastrophic_detection_curves" title="Link to this definition">#</a></dt>
<dd><p>Plot catastrophic error recall (dex) vs fraction flagged by uncertainty,
across multiple catastrophic percentiles, plus performance improvement curves.</p>
<p>Catastrophic errors are those with dex &gt;= P_cat (e.g. 99th percentile).
For each flag fraction f, the uncertainty threshold is the (1 - f) quantile of std.
We then flag samples with std &gt;= threshold and measure recall among catastrophic samples.</p>
<p>Additionally, computes the effective log-space MAE if flagged samples are replaced
by solver outputs (0 error). This measures how much UQ-guided deferral improves performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>errors_log</strong> (<em>dict</em>)  dex arrays [N, T, Q] per surrogate.</p></li>
<li><p><strong>std_log</strong> (<em>dict</em>)  Log-space std arrays [N, T, Q] per surrogate.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>percentiles</strong> (<em>tuple</em>)  Catastrophic percentiles to evaluate (default: (90, 95, 99)).</p></li>
<li><p><strong>flag_fractions</strong> (<em>tuple</em>)  Fractions of predictions to flag (includes 0 for baseline).</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Save figure.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Add title.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>Nested dict of results:</dt><dd><dl class="simple">
<dt>summary[surrogate][percentile] = {</dt><dd><p>flag_fraction: f, recall: r, cat_threshold: thr,
mae_curve: [(f, mae), ]</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_comparative_error_correlation_heatmaps">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_comparative_error_correlation_heatmaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_correlations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_comparative_error_correlation_heatmaps" title="Link to this definition">#</a></dt>
<dd><p>Comparative heatmaps of log-space uncertainty vs dex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds_std</strong> (<em>dict</em>)  Log-space std arrays per surrogate.</p></li>
<li><p><strong>errors</strong> (<em>dict</em>)  dex arrays per surrogate.</p></li>
<li><p><strong>avg_correlations</strong> (<em>dict</em>)  Pearson r per surrogate (log-space).</p></li>
<li><p><strong>axis_max</strong> (<em>dict</em>)  Axis maxima from per-surrogate plots.</p></li>
<li><p><strong>max_count</strong> (<em>dict</em>)  Peak counts for normalization per surrogate.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Save figure.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Add title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_comparative_gradient_heatmaps">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_comparative_gradient_heatmaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_correlations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_comparative_gradient_heatmaps" title="Link to this definition">#</a></dt>
<dd><p>Plot comparative heatmaps of correlation between gradient and prediction errors
for multiple surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gradients</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em>)  Dictionary of gradients from the ensemble of models.</p></li>
<li><p><strong>errors</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em>)  Dictionary of prediction errors.</p></li>
<li><p><strong>avg_correlations</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>)  Dictionary of average correlations between gradients and prediction errors.</p></li>
<li><p><strong>max_grad</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>)  Dictionary of maximum gradient values for axis scaling across models.</p></li>
<li><p><strong>max_err</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>)  Dictionary of maximum error values for axis scaling across models.</p></li>
<li><p><strong>max_count</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>)  Dictionary of maximum count values for heatmap normalization across models.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot. Defaults to True.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_dynamic_correlation">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_dynamic_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_dynamic_correlation" title="Link to this definition">#</a></dt>
<dd><p>Plot the correlation between the gradients of the data and the prediction errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>gradients</strong> (<em>np.ndarray</em>)  The gradients of the data.</p></li>
<li><p><strong>errors</strong> (<em>np.ndarray</em>)  The prediction errors.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_error_distribution_comparative">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_error_distribution_comparative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relative'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_error_distribution_comparative" title="Link to this definition">#</a></dt>
<dd><p>Plot comparative error distributions for each surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>errors</strong> (<em>dict</em>)  Model  array of errors [num_samples, num_timesteps, num_quantities].</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the figure.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to add a title.</p></li>
<li><p><strong>mode</strong> (<em>str</em>)  relative (unitless %) or deltadex (log-space abs. errors).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_error_distribution_per_quantity">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_error_distribution_per_quantity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantity_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_quantities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_error_distribution_per_quantity" title="Link to this definition">#</a></dt>
<dd><p>Plot the distribution of errors for each quantity as a smoothed histogram plot.</p>
<ul class="simple">
<li><dl class="simple">
<dt>mode=relative:</dt><dd><p>Errors are relative (0..).
Histogram is plotted in log-space (x-axis log-scaled).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>mode=deltadex:</dt><dd><p>Errors are absolute log-space errors (dex  0).
Histogram is plotted on linear scale.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>errors</strong> (<em>np.ndarray</em>)  Errors array of shape [num_samples, num_timesteps, num_quantities].</p></li>
<li><p><strong>quantity_names</strong> (<em>list</em><em>, </em><em>optional</em>)  List of quantity names for labeling the lines.</p></li>
<li><p><strong>num_quantities</strong> (<em>int</em><em>, </em><em>optional</em>)  Number of quantities to plot. Default is 10.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>)  relative or deltadex. Default is relative.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot as a file.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_error_percentiles_over_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_error_percentiles_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_error_percentiles_over_time" title="Link to this definition">#</a></dt>
<dd><p>Plot mean, median, and percentile error envelopes over time.</p>
<ul class="simple">
<li><dl class="simple">
<dt>mode=relative:</dt><dd><p>Treats <cite>errors</cite> as relative errors (0..).
Plots bidirectional percentile bands (25-75, 5-95, 0.5-99.5).
Y-axis is log-scaled.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>mode=deltadex:</dt><dd><p>Treats <cite>errors</cite> as log-space absolute errors (dex  0).
Plots one-sided percentile bands (0-50, 0-90, 0-99).
Y-axis is linear, starting at 0.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate model (used for saving).</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary containing dataset and output settings.</p></li>
<li><p><strong>errors</strong> (<em>np.ndarray</em>)  Error array of shape [N_samples, N_timesteps, N_quantities].
Values are either relative errors or dex depending on <cite>mode</cite>.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps corresponding to the second axis of <cite>errors</cite>.</p></li>
<li><p><strong>title</strong> (<em>str</em>)  Title for the plot.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>)  relative for relative errors, deltadex for log-space absolute errors.
Defaults to relative.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot to disk. Defaults to False.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to show the plot title. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_errors_over_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_errors_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relative'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_errors_over_time" title="Link to this definition">#</a></dt>
<dd><p>Plot errors over time for different surrogate models (relative or dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean_errors</strong> (<em>dict</em>)  Mean errors for each surrogate.</p></li>
<li><p><strong>median_errors</strong> (<em>dict</em>)  Median errors for each surrogate.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the figure.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to add a title.</p></li>
<li><p><strong>mode</strong> (<em>str</em>)  relative (percentage errors) or deltadex (log-space abs. errors).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_example_iterative_predictions">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_example_iterative_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterative_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_quantities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_example_iterative_predictions" title="Link to this definition">#</a></dt>
<dd><p>Plot one samples full iterative trajectory:
ground truth vs. chained predictions, with retrigger lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_example_mode_predictions">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_example_mode_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds_main_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'interpolation'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_quantities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_example_mode_predictions" title="Link to this definition">#</a></dt>
<dd><p>Plot example predictions in log-space (dex) alongside ground truth targets
for either interpolation or extrapolation mode.</p>
<p>Predictions and targets are assumed to be in log10 space (leave_log=True).
Axis labels and plotted values are consistent with this log representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>preds_log</strong> (<em>np.ndarray</em>)  Predictions in log-space of shape [N_samples, T, Q].</p></li>
<li><p><strong>preds_main_log</strong> (<em>np.ndarray</em>)  Main model (reference) predictions in log-space of shape [N_samples, T, Q].</p></li>
<li><p><strong>targets_log</strong> (<em>np.ndarray</em>)  Targets in log-space of shape [N_samples, T, Q].</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps.</p></li>
<li><p><strong>metric</strong> (<em>int</em>)  <ul>
<li><p>In interpolation mode: the training interval (e.g., 10 means every 10th timestep was used).</p></li>
<li><p>In extrapolation mode: the cutoff timestep index.</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>)  Either interpolation or extrapolation. Default is interpolation.</p></li>
<li><p><strong>example_idx</strong> (<em>int</em><em>, </em><em>optional</em>)  Index of the example to plot. Default is 0.</p></li>
<li><p><strong>num_quantities</strong> (<em>int</em><em>, </em><em>optional</em>)  Maximum number of quantities to plot. Default is 100.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>)  Names of the quantities to display in legends.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the figure. Default is False.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to add a title to the figure. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_example_predictions_with_uncertainty">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_example_predictions_with_uncertainty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_quantities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_example_predictions_with_uncertainty" title="Link to this definition">#</a></dt>
<dd><p>Plot example predictions with uncertainty in log10 space (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>log_mean</strong> (<em>np.ndarray</em>)  Ensemble mean predictions in log10 space.</p></li>
<li><p><strong>log_std</strong> (<em>np.ndarray</em>)  Ensemble standard deviation in log10 space.</p></li>
<li><p><strong>log_targets</strong> (<em>np.ndarray</em>)  Ground truth targets in log10 space.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps.</p></li>
<li><p><strong>example_idx</strong> (<em>int</em>)  Index of the example to plot.</p></li>
<li><p><strong>num_quantities</strong> (<em>int</em>)  Number of species/quantities to plot.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>optional</em>)  Quantity labels.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the figure.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to display a title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_generalization_error_comparison">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_generalization_error_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_errors_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_generalization_error_comparison" title="Link to this definition">#</a></dt>
<dd><p>Plot the generalization errors of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogates</strong> (<em>list</em>)  List of surrogate model names.</p></li>
<li><p><strong>metrics_list</strong> (<em>list</em><em>[</em><em>np.array</em><em>]</em>)  List of numpy arrays containing the metrics for each surrogate model.</p></li>
<li><p><strong>model_errors_list</strong> (<em>list</em><em>[</em><em>np.array</em><em>]</em>)  List of numpy arrays containing the errors for each surrogate model.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em>)  Label for the x-axis.</p></li>
<li><p><strong>filename</strong> (<em>str</em>)  Filename to save the plot.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>xlog</strong> (<em>bool</em>)  Whether to use a log scale for the x-axis.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_generalization_errors">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_generalization_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_generalization_errors" title="Link to this definition">#</a></dt>
<dd><p>Plot the generalization errors of a model for various metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>metrics</strong> (<em>np.ndarray</em>)  The metrics (e.g., intervals, cutoffs, batch sizes, number of training samples).</p></li>
<li><p><strong>model_errors</strong> (<em>np.ndarray</em>)  The model errors.</p></li>
<li><p><strong>mode</strong> (<em>str</em>)  The mode of generalization (interpolation, extrapolation, sparse, batchsize).</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_gradients_heatmap">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_gradients_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_correlation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.98</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_gradients_heatmap" title="Link to this definition">#</a></dt>
<dd><p>Plot correlation between gradients (normalized) and dex errors using a heatmap.</p>
<p>Both gradients and errors are in log-space.
Gradients are normalized, errors are absolute log differences (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Surrogate name.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Config dictionary.</p></li>
<li><p><strong>gradients</strong> (<em>np.ndarray</em>)  Normalized log-space gradients.</p></li>
<li><p><strong>errors_log</strong> (<em>np.ndarray</em>)  dex errors.</p></li>
<li><p><strong>average_correlation</strong> (<em>float</em>)  Mean correlation value.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Save plot.</p></li>
<li><p><strong>cutoff_mass</strong> (<em>float</em>)  Fraction of mass to retain in axes.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Show title.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Histogram stats for reuse.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(max_value, x_max, y_max)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_loss_comparison">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_loss_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_loss_comparison" title="Link to this definition">#</a></dt>
<dd><p>Plot the training and test losses for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_losses</strong> (<em>tuple</em>)  Tuple of training loss arrays for each surrogate model.</p></li>
<li><p><strong>test_losses</strong> (<em>tuple</em>)  Tuple of test loss arrays for each surrogate model.</p></li>
<li><p><strong>labels</strong> (<em>tuple</em>)  Tuple of labels for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_loss_comparison_equal">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_loss_comparison_equal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_loss_comparison_equal" title="Link to this definition">#</a></dt>
<dd><p>Plot the test loss trajectories for different surrogate models on a single plot,
after log-transforming and normalizing each trajectory. This makes it easier
to see convergence behavior even when the losses span several orders of magnitude.
Numeric y-axis labels are removed.</p>
<p>Each loss trajectory is processed as follows:
1. Log-transform the loss values.
2. Normalize the log-transformed values to the range [0, 1].
3. Plot the normalized trajectory on a normalized x-axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_losses</strong> (<em>tuple</em>)  Tuple of training loss arrays for each surrogate model.</p></li>
<li><p><strong>test_losses</strong> (<em>tuple</em>)  Tuple of test loss arrays for each surrogate model.</p></li>
<li><p><strong>labels</strong> (<em>tuple</em>)  Tuple of labels for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_loss_comparison_train_duration">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_loss_comparison_train_duration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_durations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_loss_comparison_train_duration" title="Link to this definition">#</a></dt>
<dd><p>Plot the test loss trajectories for different surrogate models over training duration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_losses</strong> (<em>tuple</em>)  Tuple of test loss arrays for each surrogate model.</p></li>
<li><p><strong>labels</strong> (<em>tuple</em>)  Tuple of labels for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.#</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_losses">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_histories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Losses'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'main'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_losses" title="Link to this definition">#</a></dt>
<dd><p>Plot the loss trajectories for the training of multiple models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_histories</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>]</span>)  List of loss history arrays.</p></li>
<li><p><strong>epochs</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>)  Number of epochs.</p></li>
<li><p><strong>labels</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>]</span>)  List of labels for each loss history.</p></li>
<li><p><strong>title</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>)  Title of the plot.</p></li>
<li><p><strong>save</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>)  Whether to save the plot as an image file.</p></li>
<li><p><strong>conf</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]</span>)  The configuration dictionary.</p></li>
<li><p><strong>surr_name</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span>)  The name of the surrogate model.</p></li>
<li><p><strong>mode</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>)  The mode of the training.</p></li>
<li><p><strong>percentage</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>)  Percentage of initial values to exclude from min-max calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
<p>show_title (bool): Whether to show the title on the plot.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_losses_dual_axis">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_losses_dual_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('Train</span> <span class="pre">Loss',</span> <span class="pre">'Test</span> <span class="pre">Loss')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Losses'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_losses_dual_axis" title="Link to this definition">#</a></dt>
<dd><p>Plot the training and test loss trajectories with dual y-axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loss</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code></span>)  Training loss history array.</p></li>
<li><p><strong>test_loss</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code></span>)  Test loss history array.</p></li>
<li><p><strong>labels</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span>)  Labels for the losses (train and test).</p></li>
<li><p><strong>title</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>)  Title of the plot.</p></li>
<li><p><strong>save</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>)  Whether to save the plot as an image file.</p></li>
<li><p><strong>conf</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]</span>)  The configuration dictionary.</p></li>
<li><p><strong>surr_name</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span>)  The name of the surrogate model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
<p>show_title (bool): Whether to show the title on the plot.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_mean_deltadex_over_time_main_vs_ensemble">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_mean_deltadex_over_time_main_vs_ensemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">main_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_mean_deltadex_over_time_main_vs_ensemble" title="Link to this definition">#</a></dt>
<dd><p>Plot mean dex over time for each surrogate: main vs ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>main_errors</strong> (<em>dict</em>)  Main model dex arrays [N, T, Q] per surrogate.</p></li>
<li><p><strong>ensemble_errors</strong> (<em>dict</em>)  Ensemble dex arrays [N, T, Q] per surrogate.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps array.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save figure.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to add a title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_relative_errors">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_relative_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_relative_errors" title="Link to this definition">#</a></dt>
<dd><p>Plot the relative errors over time for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean_errors</strong> (<em>dict</em>)  Dictionary containing the mean relative errors for each surrogate model.</p></li>
<li><p><strong>median_errors</strong> (<em>dict</em>)  Dictionary containing the median relative errors for each surrogate model.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_surr_losses">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_surr_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_surr_losses" title="Link to this definition">#</a></dt>
<dd><p>Plot the training and test losses for the surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Instance of the surrogate model class.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  The timesteps array.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_uncertainty_confidence">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_uncertainty_confidence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weighted_diffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summary_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_uncertainty_confidence" title="Link to this definition">#</a></dt>
<dd><p>Plot a comparative grouped bar chart of catastrophic confidence measures and return a metric
quantifying the net skew of over- versus underconfidence.</p>
<dl class="simple">
<dt>For each surrogate model, the target-weighted difference is computed as:</dt><dd><p>weighted_diff = (predicted uncertainty - <a href="#id1"><span class="problematic" id="id2">|prediction - target|</span></a>) / target.</p>
</dd>
</dl>
<p>Negative values indicate overconfidence (i.e. the models uncertainty is too low relative to its error),
while positive values indicate underconfidence.</p>
<p>Catastrophic events are defined as those samples in the lowest <cite>percentile</cite> (e.g. 2nd percentile)
for overconfidence and in the highest <cite>percentile</cite> (i.e. 100 - percentile) for underconfidence.</p>
<p>For each surrogate, this function computes the mean and standard deviation of the weighted
differences in both tails, then plots them as grouped bars (overconfidence bars on the left,
underconfidence bars on the right) with standard error bars (thin, with capsize=3). The bar heights
are expressed in percentages.</p>
<p>The text labels for the bars are placed on the opposite side of the x-axis: for negative (overconfident)
values the annotation is shown a few pixels above the x-axis, and for positive (underconfident) values
it is shown a few pixels below the x-axis.</p>
<p>The plot title includes the metric (mean  std) and the number of samples (per tail).</p>
<p>Additionally, if the range between the smallest and largest bar is more than two orders of magnitude,
the y-axis is set to a symmetric log scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weighted_diffs</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em>)  Dictionary of weighted_diff arrays for each surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot.</p></li>
<li><p><strong>percentile</strong> (<em>float</em><em>, </em><em>optional</em>)  Percentile threshold for defining catastrophic events (default is 2).</p></li>
<li><p><strong>summary_stat</strong> (<em>str</em><em>, </em><em>optional</em>)  Currently only mean is implemented.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping surrogate names to the net difference (over_summary + under_summary).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[str, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_uncertainty_heatmap">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_uncertainty_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_correlation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.98</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_uncertainty_heatmap" title="Link to this definition">#</a></dt>
<dd><p>Plot correlation between predictive log-space uncertainty and log-space errors (delta dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>preds_std</strong> (<em>np.ndarray</em>)  Log-space ensemble standard deviation.</p></li>
<li><p><strong>errors</strong> (<em>np.ndarray</em>)  Log-space prediction errors.</p></li>
<li><p><strong>average_correlation</strong> (<em>float</em>)  Correlation between log uncertainty and log error.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the figure.</p></li>
<li><p><strong>cutoff_mass</strong> (<em>float</em>)  Fraction of mass to keep in histogram.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show a title.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(max histogram count, axis_max used for plotting).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_uncertainty_over_time_comparison">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_uncertainty_over_time_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uncertainties</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_uncertainty_over_time_comparison" title="Link to this definition">#</a></dt>
<dd><p>Plot log-space uncertainty and dex over time for multiple surrogates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uncertainties</strong> (<em>dict</em>)  Mean log-space std over time per surrogate (1 time series).</p></li>
<li><p><strong>absolute_errors</strong> (<em>dict</em>)  dex arrays [N, T, Q] per surrogate.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps array.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Save figure.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Add title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.plot_uncertainty_vs_errors">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">plot_uncertainty_vs_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.plot_uncertainty_vs_errors" title="Link to this definition">#</a></dt>
<dd><p>Plot the correlation between predictive uncertainty and prediction errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>preds_std</strong> (<em>np.ndarray</em>)  Standard deviation of predictions from the ensemble of models.</p></li>
<li><p><strong>errors</strong> (<em>np.ndarray</em>)  Prediction errors.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot as a file.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.rel_errors_and_uq">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">rel_errors_and_uq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.rel_errors_and_uq" title="Link to this definition">#</a></dt>
<dd><p>Create a figure with two subplots: relative errors over time and uncertainty over time for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em>)  Dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.save_plot">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">save_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plots'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increase_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jpg'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.save_plot" title="Link to this definition">#</a></dt>
<dd><p>Save the plot to a file, creating necessary directories if they dont exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plt</strong> (<em>matplotlib.pyplot</em>)  The plot object to save.</p></li>
<li><p><strong>filename</strong> (<em>str</em>)  The desired filename for the plot.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>dpi</strong> (<em>int</em>)  The resolution of the saved plot.</p></li>
<li><p><strong>base_dir</strong> (<em>str</em><em>, </em><em>optional</em>)  The base directory where plots will be saved. Default is plots.</p></li>
<li><p><strong>increase_count</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to increment the filename count if a file already exists. Default is True.</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>)  The format for saving the plot. Default is png. Can be png, pdf, svg, etc.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong>  If the configuration dictionary does not contain the required keys.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_plots.save_plot_counter">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_plots.</span></span><span class="sig-name descname"><span class="pre">save_plot_counter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increase_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_plots.save_plot_counter" title="Link to this definition">#</a></dt>
<dd><p>Save a plot with an incremented filename if a file with the same name already exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>)  The desired filename for the plot.</p></li>
<li><p><strong>directory</strong> (<em>str</em>)  The directory to save the plot in.</p></li>
<li><p><strong>increase_count</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to increment the filename count if a file already exists. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The full path to the saved plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-codes.benchmark.bench_utils">
<span id="codes-benchmark-bench-utils-module"></span><h2>codes.benchmark.bench_utils module<a class="headerlink" href="#module-codes.benchmark.bench_utils" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.check_benchmark">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">check_benchmark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.check_benchmark" title="Link to this definition">#</a></dt>
<dd><p>Check whether there are any configuration issues with the benchmark.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>FileNotFoundError</strong>  If the training ID directory is missing or if the .yaml file is missing.</p></li>
<li><p><strong>ValueError</strong>  If the configuration is missing required keys or the values do not match the training configuration.</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.check_surrogate">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">check_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.check_surrogate" title="Link to this definition">#</a></dt>
<dd><p>Check whether the required models for the benchmark are present in the expected directories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogate</strong> (<em>str</em>)  The name of the surrogate model to check.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong>  If any required models are missing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.clean_metrics">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">clean_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.clean_metrics" title="Link to this definition">#</a></dt>
<dd><p>Clean the metrics dictionary to remove problematic entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em>)  The benchmark metrics.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The cleaned metrics dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.convert_dict_to_scientific_notation">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">convert_dict_to_scientific_notation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.convert_dict_to_scientific_notation" title="Link to this definition">#</a></dt>
<dd><p>Convert all numerical values in a dictionary to scientific notation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>dict</em>)  The input dictionary.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dictionary with numerical values in scientific notation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.convert_to_standard_types">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">convert_to_standard_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.convert_to_standard_types" title="Link to this definition">#</a></dt>
<dd><p>Recursively convert data to standard types that can be serialized to YAML.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong>  The data to convert.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The converted data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.count_trainable_parameters">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">count_trainable_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.count_trainable_parameters" title="Link to this definition">#</a></dt>
<dd><p>Count the number of trainable parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>torch.nn.Module</em>)  The PyTorch model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of trainable parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.discard_numpy_entries">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">discard_numpy_entries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.discard_numpy_entries" title="Link to this definition">#</a></dt>
<dd><p>Recursively remove dictionary entries that contain NumPy arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>dict</em>)  The input dictionary.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new dictionary without entries containing NumPy arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.flatten_dict">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">flatten_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">-</span> <span class="pre">'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.flatten_dict" title="Link to this definition">#</a></dt>
<dd><p>Flatten a nested dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>dict</em>)  The dictionary to flatten.</p></li>
<li><p><strong>parent_key</strong> (<em>str</em>)  The base key string.</p></li>
<li><p><strong>sep</strong> (<em>str</em>)  The separator between keys.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flattened dictionary with composite keys.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.format_seconds">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">format_seconds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.format_seconds" title="Link to this definition">#</a></dt>
<dd><p>Format a duration given in seconds as hh:mm:ss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seconds</strong> (<em>int</em>)  The duration in seconds.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The formatted duration string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.format_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">format_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.format_time" title="Link to this definition">#</a></dt>
<dd><p>Format mean and std time consistently in ns, s, ms, or s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean_time</strong>  The mean time.</p></li>
<li><p><strong>std_time</strong>  The standard deviation of the time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The formatted time string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.format_value">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">format_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.format_value" title="Link to this definition">#</a></dt>
<dd><p>Format a float with ~3 significant digits, in fixed or scientific notation.
Optionally append a suffix (e.g. dex, MB).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>float</em>)  Value to format.</p></li>
<li><p><strong>suffix</strong> (<em>str</em>)  Unit/suffix to append, e.g. dex. Ignored if as_percent=True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Formatted string with optional suffix or percent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.get_model_config">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">get_model_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.get_model_config" title="Link to this definition">#</a></dt>
<dd><p>Get the model configuration for a specific surrogate model from the dataset folder.
Returns an empty dictionary if config[dataset][use_optimal_params] is False,
or if no configuration file is found in the dataset folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The model configuration dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.get_required_models_list">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">get_required_models_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.get_required_models_list" title="Link to this definition">#</a></dt>
<dd><p>Generate a list of required models based on the configuration settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogate</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of required model names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.get_surrogate">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">get_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.get_surrogate" title="Link to this definition">#</a></dt>
<dd><p>Check if the surrogate model exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>surrogate_name</strong> (<em>str</em>)  The name of the surrogate model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The surrogate model class if it exists, otherwise None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>SurrogateModel | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.load_model">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_identifier</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.load_model" title="Link to this definition">#</a></dt>
<dd><p>Load a trained surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Instance of the surrogate model class.</p></li>
<li><p><strong>training_id</strong> (<em>str</em>)  The training identifier.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>model_identifier</strong> (<em>str</em>)  The identifier of the model (e.g., main).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The loaded surrogate model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.make_comparison_csv">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">make_comparison_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.make_comparison_csv" title="Link to this definition">#</a></dt>
<dd><p>Generate a CSV file comparing metrics for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em>)  Dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.measure_inference_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">measure_inference_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.measure_inference_time" title="Link to this definition">#</a></dt>
<dd><p>Measure total inference time over a DataLoader across multiple runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Model instance with a <cite>.forward()</cite> method.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  Loader with test data.</p></li>
<li><p><strong>n_runs</strong> (<em>int</em>)  Number of repeated runs for averaging.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of total inference times per run (in seconds).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.measure_memory_footprint">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">measure_memory_footprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.measure_memory_footprint" title="Link to this definition">#</a></dt>
<dd><p>Measure the memory footprint of a model during forward and backward passes using
peak memory tracking and explicit synchronization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>)  The PyTorch model.</p></li>
<li><p><strong>inputs</strong> (<em>tuple</em>)  The input data for the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary containing measured memory usages for:</dt><dd><ul class="simple">
<li><p>model_memory: Additional memory used when moving the model to GPU.</p></li>
<li><p>forward_memory: Peak additional memory during the forward pass with gradients.</p></li>
<li><p>backward_memory: Peak additional memory during the backward pass.</p></li>
<li><p>forward_memory_nograd: Peak additional memory during the forward pass without gradients.</p></li>
</ul>
</dd>
</dl>
<p>model: The model (possibly moved back to the original device).</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.save_table_csv">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">save_table_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.save_table_csv" title="Link to this definition">#</a></dt>
<dd><p>Save the CLI table (headers and rows) to a CSV file.
This version strips out any formatting (like asterisks) from the table cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>headers</strong> (<em>list</em>)  The list of header names.</p></li>
<li><p><strong>rows</strong> (<em>list</em>)  The list of rows, where each row is a list of string values.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary that contains training_id.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.bench_utils.write_metrics_to_yaml">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.bench_utils.</span></span><span class="sig-name descname"><span class="pre">write_metrics_to_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.bench_utils.write_metrics_to_yaml" title="Link to this definition">#</a></dt>
<dd><p>Write the benchmark metrics to a YAML file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>)  The benchmark metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-codes.benchmark">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-codes.benchmark" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.check_benchmark">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">check_benchmark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.check_benchmark" title="Link to this definition">#</a></dt>
<dd><p>Check whether there are any configuration issues with the benchmark.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>FileNotFoundError</strong>  If the training ID directory is missing or if the .yaml file is missing.</p></li>
<li><p><strong>ValueError</strong>  If the configuration is missing required keys or the values do not match the training configuration.</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.check_surrogate">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">check_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.check_surrogate" title="Link to this definition">#</a></dt>
<dd><p>Check whether the required models for the benchmark are present in the expected directories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogate</strong> (<em>str</em>)  The name of the surrogate model to check.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong>  If any required models are missing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.clean_metrics">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">clean_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.clean_metrics" title="Link to this definition">#</a></dt>
<dd><p>Clean the metrics dictionary to remove problematic entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em>)  The benchmark metrics.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The cleaned metrics dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.compare_UQ">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">compare_UQ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.compare_UQ" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Compare log-space UQ across surrogates, focusing on:</dt><dd><ul class="simple">
<li><p>Ensemble vs Main errors (dex) over time</p></li>
<li><p>Correlation between log-space uncertainty and errors</p></li>
<li><p>Catastrophic-error detection from uncertainty thresholds</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_metrics</strong> (<em>dict</em>)  Benchmark metrics per surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.compare_batchsize">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">compare_batchsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.compare_batchsize" title="Link to this definition">#</a></dt>
<dd><p>Compare the batch size training errors of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.compare_errors">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">compare_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.compare_errors" title="Link to this definition">#</a></dt>
<dd><p>Compare relative errors and dex errors over time for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em>)  Benchmark metrics for each surrogate.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.compare_extrapolation">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">compare_extrapolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.compare_extrapolation" title="Link to this definition">#</a></dt>
<dd><p>Compare the extrapolation errors of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.compare_gradients">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">compare_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.compare_gradients" title="Link to this definition">#</a></dt>
<dd><p>Compare the gradients of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.compare_inference_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">compare_inference_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.compare_inference_time" title="Link to this definition">#</a></dt>
<dd><p>Compare the mean inference time of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>dict</em><em>]</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.compare_interpolation">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">compare_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.compare_interpolation" title="Link to this definition">#</a></dt>
<dd><p>Compare the interpolation errors of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.compare_main_losses">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">compare_main_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.compare_main_losses" title="Link to this definition">#</a></dt>
<dd><p>Compare the training and test losses of the main models for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.compare_models">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">compare_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.compare_models" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.compare_sparse">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">compare_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.compare_sparse" title="Link to this definition">#</a></dt>
<dd><p>Compare the sparse training errors of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.convert_dict_to_scientific_notation">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">convert_dict_to_scientific_notation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.convert_dict_to_scientific_notation" title="Link to this definition">#</a></dt>
<dd><p>Convert all numerical values in a dictionary to scientific notation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>dict</em>)  The input dictionary.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dictionary with numerical values in scientific notation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.convert_to_standard_types">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">convert_to_standard_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.convert_to_standard_types" title="Link to this definition">#</a></dt>
<dd><p>Recursively convert data to standard types that can be serialized to YAML.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong>  The data to convert.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The converted data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.count_trainable_parameters">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">count_trainable_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.count_trainable_parameters" title="Link to this definition">#</a></dt>
<dd><p>Count the number of trainable parameters in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>torch.nn.Module</em>)  The PyTorch model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of trainable parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.discard_numpy_entries">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">discard_numpy_entries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.discard_numpy_entries" title="Link to this definition">#</a></dt>
<dd><p>Recursively remove dictionary entries that contain NumPy arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>dict</em>)  The input dictionary.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new dictionary without entries containing NumPy arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.evaluate_UQ">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">evaluate_UQ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.evaluate_UQ" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the uncertainty quantification (UQ) performance of the surrogate model.</p>
<p>Predictions and targets are kept in log10 space (leave_log=True).
All UQ metrics are computed in log space (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  The surrogate model instance.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  DataLoader with the test data.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>optional</em>)  Labels for the predicted quantities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing log-space UQ metrics and arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.evaluate_accuracy">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">evaluate_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.evaluate_accuracy" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the accuracy of the surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Instance of the surrogate model class.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  The timesteps array.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  The DataLoader object containing the test data.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>optional</em>)  The labels for the quantities.</p></li>
<li><p><strong>percentile</strong> (<em>int</em><em>, </em><em>optional</em>)  The percentile for error metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing accuracy metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.evaluate_batchsize">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">evaluate_batchsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.evaluate_batchsize" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the batch-size scaling performance of the surrogate model in log-space (dex).</p>
<p>Predictions and targets are kept in log10 space (leave_log=True).
Errors are computed as absolute log differences (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Surrogate model instance.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  DataLoader with test data.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps array.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Batch-size scaling metrics in log-space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.evaluate_compute">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">evaluate_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.evaluate_compute" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the computational resource requirements of the surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Instance of the surrogate model class.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  The DataLoader object containing the test data.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing model complexity metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.evaluate_extrapolation">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">evaluate_extrapolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.evaluate_extrapolation" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the extrapolation performance of the surrogate model in log-space (dex).</p>
<p>Predictions and targets are kept in log10 space (leave_log=True).
Errors are computed as absolute log differences (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Surrogate model instance.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  DataLoader with test data.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps array.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>optional</em>)  Labels for the predicted quantities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Extrapolation metrics in log-space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.evaluate_gradients">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">evaluate_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.evaluate_gradients" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the gradients of the surrogate model in log-space (dex).</p>
<p>Predictions and targets are kept in log10 space (leave_log=True).
Errors are computed as absolute log differences (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Surrogate model instance.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  Surrogate name.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  Test data.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>species_names</strong> (<em>list</em><em>, </em><em>optional</em>)  Names of the species/quantities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradienterror correlation metrics in log-space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.evaluate_interpolation">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">evaluate_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.evaluate_interpolation" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the interpolation performance of the surrogate model in log-space (dex).</p>
<p>Predictions and targets are kept in log10 space (leave_log=True).
Errors are computed as absolute log differences (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Surrogate model instance.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  DataLoader with test data.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps array.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>optional</em>)  Labels for the predicted quantities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolation metrics in log-space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.evaluate_sparse">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">evaluate_sparse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_train_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.evaluate_sparse" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the sparse-data training performance of the surrogate model in log-space (dex).</p>
<p>Predictions and targets are kept in log10 space (leave_log=True).
Errors are computed as absolute log differences (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Surrogate model instance.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  DataLoader with test data.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps array.</p></li>
<li><p><strong>n_train_samples</strong> (<em>int</em>)  Number of training samples in the full dataset.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sparse training metrics in log-space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.flatten_dict">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">flatten_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">-</span> <span class="pre">'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.flatten_dict" title="Link to this definition">#</a></dt>
<dd><p>Flatten a nested dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>dict</em>)  The dictionary to flatten.</p></li>
<li><p><strong>parent_key</strong> (<em>str</em>)  The base key string.</p></li>
<li><p><strong>sep</strong> (<em>str</em>)  The separator between keys.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flattened dictionary with composite keys.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.format_seconds">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">format_seconds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seconds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.format_seconds" title="Link to this definition">#</a></dt>
<dd><p>Format a duration given in seconds as hh:mm:ss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seconds</strong> (<em>int</em>)  The duration in seconds.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The formatted duration string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.format_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">format_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.format_time" title="Link to this definition">#</a></dt>
<dd><p>Format mean and std time consistently in ns, s, ms, or s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean_time</strong>  The mean time.</p></li>
<li><p><strong>std_time</strong>  The standard deviation of the time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The formatted time string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.format_value">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">format_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.format_value" title="Link to this definition">#</a></dt>
<dd><p>Format a float with ~3 significant digits, in fixed or scientific notation.
Optionally append a suffix (e.g. dex, MB).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>float</em>)  Value to format.</p></li>
<li><p><strong>suffix</strong> (<em>str</em>)  Unit/suffix to append, e.g. dex. Ignored if as_percent=True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Formatted string with optional suffix or percent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.get_custom_palette">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">get_custom_palette</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_colors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.get_custom_palette" title="Link to this definition">#</a></dt>
<dd><p>Returns a list of colors sampled from a custom color palette.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_colors</strong> (<em>int</em>)  The number of colors needed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of RGBA color tuples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.get_model_config">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">get_model_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.get_model_config" title="Link to this definition">#</a></dt>
<dd><p>Get the model configuration for a specific surrogate model from the dataset folder.
Returns an empty dictionary if config[dataset][use_optimal_params] is False,
or if no configuration file is found in the dataset folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The model configuration dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.get_required_models_list">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">get_required_models_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.get_required_models_list" title="Link to this definition">#</a></dt>
<dd><p>Generate a list of required models based on the configuration settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogate</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of required model names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.get_surrogate">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">get_surrogate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogate_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.get_surrogate" title="Link to this definition">#</a></dt>
<dd><p>Check if the surrogate model exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>surrogate_name</strong> (<em>str</em>)  The name of the surrogate model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The surrogate model class if it exists, otherwise None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>SurrogateModel | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.inference_time_bar_plot">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">inference_time_bar_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">means</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.inference_time_bar_plot" title="Link to this definition">#</a></dt>
<dd><p>Plot the mean inference time with standard deviation for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogates</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)  List of surrogate model names.</p></li>
<li><p><strong>means</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>)  List of mean inference times for each surrogate model.</p></li>
<li><p><strong>stds</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>)  List of standard deviation of inference times for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot. Defaults to True.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.load_model">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_identifier</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.load_model" title="Link to this definition">#</a></dt>
<dd><p>Load a trained surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Instance of the surrogate model class.</p></li>
<li><p><strong>training_id</strong> (<em>str</em>)  The training identifier.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>model_identifier</strong> (<em>str</em>)  The identifier of the model (e.g., main).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The loaded surrogate model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.make_comparison_csv">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">make_comparison_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.make_comparison_csv" title="Link to this definition">#</a></dt>
<dd><p>Generate a CSV file comparing metrics for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em>)  Dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.measure_inference_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">measure_inference_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.measure_inference_time" title="Link to this definition">#</a></dt>
<dd><p>Measure total inference time over a DataLoader across multiple runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Model instance with a <cite>.forward()</cite> method.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  Loader with test data.</p></li>
<li><p><strong>n_runs</strong> (<em>int</em>)  Number of repeated runs for averaging.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of total inference times per run (in seconds).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.measure_memory_footprint">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">measure_memory_footprint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.measure_memory_footprint" title="Link to this definition">#</a></dt>
<dd><p>Measure the memory footprint of a model during forward and backward passes using
peak memory tracking and explicit synchronization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>)  The PyTorch model.</p></li>
<li><p><strong>inputs</strong> (<em>tuple</em>)  The input data for the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary containing measured memory usages for:</dt><dd><ul class="simple">
<li><p>model_memory: Additional memory used when moving the model to GPU.</p></li>
<li><p>forward_memory: Peak additional memory during the forward pass with gradients.</p></li>
<li><p>backward_memory: Peak additional memory during the backward pass.</p></li>
<li><p>forward_memory_nograd: Peak additional memory during the forward pass without gradients.</p></li>
</ul>
</dd>
</dl>
<p>model: The model (possibly moved back to the original device).</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_MAE_comparison">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_MAE_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MAEs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_MAE_comparison" title="Link to this definition">#</a></dt>
<dd><p>Plot the MAE for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>MAE</strong> (<em>tuple</em>)  Tuple of accuracy arrays for each surrogate model.</p></li>
<li><p><strong>labels</strong> (<em>tuple</em>)  Tuple of labels for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_all_generalization_errors">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_all_generalization_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_all_generalization_errors" title="Link to this definition">#</a></dt>
<dd><p>Function to make one comparative plot of the interpolation, extrapolation, sparse, and batch size errors.
Only the modalities present in all_metrics will be plotted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_metrics</strong> (<em>dict</em>)  dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_average_errors_over_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_average_errors_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_average_errors_over_time" title="Link to this definition">#</a></dt>
<dd><p>Plot dex errors over time for different evaluation modes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Surrogate name.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Config dictionary.</p></li>
<li><p><strong>errors</strong> (<em>np.ndarray</em>)  Errors [N_metrics, n_timesteps].</p></li>
<li><p><strong>metrics</strong> (<em>np.ndarray</em>)  Metrics [N_metrics].</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps.</p></li>
<li><p><strong>mode</strong> (<em>str</em>)  One of interpolation, extrapolation, sparse, batchsize.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_average_uncertainty_over_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_average_uncertainty_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_average_uncertainty_over_time" title="Link to this definition">#</a></dt>
<dd><p>Plot average predictive uncertainty and errors over time in log-space (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>errors_time</strong> (<em>np.ndarray</em>)  Log-space prediction errors over time.</p></li>
<li><p><strong>preds_std</strong> (<em>np.ndarray</em>)  Log-space ensemble standard deviation over time.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show a title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_comparative_error_correlation_heatmaps">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_comparative_error_correlation_heatmaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_correlations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_comparative_error_correlation_heatmaps" title="Link to this definition">#</a></dt>
<dd><p>Comparative heatmaps of log-space uncertainty vs dex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds_std</strong> (<em>dict</em>)  Log-space std arrays per surrogate.</p></li>
<li><p><strong>errors</strong> (<em>dict</em>)  dex arrays per surrogate.</p></li>
<li><p><strong>avg_correlations</strong> (<em>dict</em>)  Pearson r per surrogate (log-space).</p></li>
<li><p><strong>axis_max</strong> (<em>dict</em>)  Axis maxima from per-surrogate plots.</p></li>
<li><p><strong>max_count</strong> (<em>dict</em>)  Peak counts for normalization per surrogate.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Save figure.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Add title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_comparative_gradient_heatmaps">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_comparative_gradient_heatmaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">avg_correlations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_comparative_gradient_heatmaps" title="Link to this definition">#</a></dt>
<dd><p>Plot comparative heatmaps of correlation between gradient and prediction errors
for multiple surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gradients</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em>)  Dictionary of gradients from the ensemble of models.</p></li>
<li><p><strong>errors</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em>)  Dictionary of prediction errors.</p></li>
<li><p><strong>avg_correlations</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>)  Dictionary of average correlations between gradients and prediction errors.</p></li>
<li><p><strong>max_grad</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>)  Dictionary of maximum gradient values for axis scaling across models.</p></li>
<li><p><strong>max_err</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>)  Dictionary of maximum error values for axis scaling across models.</p></li>
<li><p><strong>max_count</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em>)  Dictionary of maximum count values for heatmap normalization across models.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot. Defaults to True.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_dynamic_correlation">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_dynamic_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_dynamic_correlation" title="Link to this definition">#</a></dt>
<dd><p>Plot the correlation between the gradients of the data and the prediction errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>gradients</strong> (<em>np.ndarray</em>)  The gradients of the data.</p></li>
<li><p><strong>errors</strong> (<em>np.ndarray</em>)  The prediction errors.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_error_distribution_comparative">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_error_distribution_comparative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relative'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_error_distribution_comparative" title="Link to this definition">#</a></dt>
<dd><p>Plot comparative error distributions for each surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>errors</strong> (<em>dict</em>)  Model  array of errors [num_samples, num_timesteps, num_quantities].</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the figure.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to add a title.</p></li>
<li><p><strong>mode</strong> (<em>str</em>)  relative (unitless %) or deltadex (log-space abs. errors).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_error_distribution_per_quantity">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_error_distribution_per_quantity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantity_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_quantities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_error_distribution_per_quantity" title="Link to this definition">#</a></dt>
<dd><p>Plot the distribution of errors for each quantity as a smoothed histogram plot.</p>
<ul class="simple">
<li><dl class="simple">
<dt>mode=relative:</dt><dd><p>Errors are relative (0..).
Histogram is plotted in log-space (x-axis log-scaled).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>mode=deltadex:</dt><dd><p>Errors are absolute log-space errors (dex  0).
Histogram is plotted on linear scale.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>errors</strong> (<em>np.ndarray</em>)  Errors array of shape [num_samples, num_timesteps, num_quantities].</p></li>
<li><p><strong>quantity_names</strong> (<em>list</em><em>, </em><em>optional</em>)  List of quantity names for labeling the lines.</p></li>
<li><p><strong>num_quantities</strong> (<em>int</em><em>, </em><em>optional</em>)  Number of quantities to plot. Default is 10.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>)  relative or deltadex. Default is relative.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot as a file.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_error_percentiles_over_time">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_error_percentiles_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_error_percentiles_over_time" title="Link to this definition">#</a></dt>
<dd><p>Plot mean, median, and percentile error envelopes over time.</p>
<ul class="simple">
<li><dl class="simple">
<dt>mode=relative:</dt><dd><p>Treats <cite>errors</cite> as relative errors (0..).
Plots bidirectional percentile bands (25-75, 5-95, 0.5-99.5).
Y-axis is log-scaled.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>mode=deltadex:</dt><dd><p>Treats <cite>errors</cite> as log-space absolute errors (dex  0).
Plots one-sided percentile bands (0-50, 0-90, 0-99).
Y-axis is linear, starting at 0.</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate model (used for saving).</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary containing dataset and output settings.</p></li>
<li><p><strong>errors</strong> (<em>np.ndarray</em>)  Error array of shape [N_samples, N_timesteps, N_quantities].
Values are either relative errors or dex depending on <cite>mode</cite>.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps corresponding to the second axis of <cite>errors</cite>.</p></li>
<li><p><strong>title</strong> (<em>str</em>)  Title for the plot.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>)  relative for relative errors, deltadex for log-space absolute errors.
Defaults to relative.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot to disk. Defaults to False.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to show the plot title. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_example_iterative_predictions">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_example_iterative_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterative_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iter_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_quantities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_example_iterative_predictions" title="Link to this definition">#</a></dt>
<dd><p>Plot one samples full iterative trajectory:
ground truth vs. chained predictions, with retrigger lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_example_mode_predictions">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_example_mode_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds_main_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'interpolation'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_quantities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_example_mode_predictions" title="Link to this definition">#</a></dt>
<dd><p>Plot example predictions in log-space (dex) alongside ground truth targets
for either interpolation or extrapolation mode.</p>
<p>Predictions and targets are assumed to be in log10 space (leave_log=True).
Axis labels and plotted values are consistent with this log representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>preds_log</strong> (<em>np.ndarray</em>)  Predictions in log-space of shape [N_samples, T, Q].</p></li>
<li><p><strong>preds_main_log</strong> (<em>np.ndarray</em>)  Main model (reference) predictions in log-space of shape [N_samples, T, Q].</p></li>
<li><p><strong>targets_log</strong> (<em>np.ndarray</em>)  Targets in log-space of shape [N_samples, T, Q].</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps.</p></li>
<li><p><strong>metric</strong> (<em>int</em>)  <ul>
<li><p>In interpolation mode: the training interval (e.g., 10 means every 10th timestep was used).</p></li>
<li><p>In extrapolation mode: the cutoff timestep index.</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>)  Either interpolation or extrapolation. Default is interpolation.</p></li>
<li><p><strong>example_idx</strong> (<em>int</em><em>, </em><em>optional</em>)  Index of the example to plot. Default is 0.</p></li>
<li><p><strong>num_quantities</strong> (<em>int</em><em>, </em><em>optional</em>)  Maximum number of quantities to plot. Default is 100.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>)  Names of the quantities to display in legends.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the figure. Default is False.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to add a title to the figure. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_example_predictions_with_uncertainty">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_example_predictions_with_uncertainty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_quantities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_example_predictions_with_uncertainty" title="Link to this definition">#</a></dt>
<dd><p>Plot example predictions with uncertainty in log10 space (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>log_mean</strong> (<em>np.ndarray</em>)  Ensemble mean predictions in log10 space.</p></li>
<li><p><strong>log_std</strong> (<em>np.ndarray</em>)  Ensemble standard deviation in log10 space.</p></li>
<li><p><strong>log_targets</strong> (<em>np.ndarray</em>)  Ground truth targets in log10 space.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps.</p></li>
<li><p><strong>example_idx</strong> (<em>int</em>)  Index of the example to plot.</p></li>
<li><p><strong>num_quantities</strong> (<em>int</em>)  Number of species/quantities to plot.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>, </em><em>optional</em>)  Quantity labels.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the figure.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to display a title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_generalization_error_comparison">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_generalization_error_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surrogates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_errors_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_generalization_error_comparison" title="Link to this definition">#</a></dt>
<dd><p>Plot the generalization errors of different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surrogates</strong> (<em>list</em>)  List of surrogate model names.</p></li>
<li><p><strong>metrics_list</strong> (<em>list</em><em>[</em><em>np.array</em><em>]</em>)  List of numpy arrays containing the metrics for each surrogate model.</p></li>
<li><p><strong>model_errors_list</strong> (<em>list</em><em>[</em><em>np.array</em><em>]</em>)  List of numpy arrays containing the errors for each surrogate model.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em>)  Label for the x-axis.</p></li>
<li><p><strong>filename</strong> (<em>str</em>)  Filename to save the plot.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>xlog</strong> (<em>bool</em>)  Whether to use a log scale for the x-axis.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_generalization_errors">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_generalization_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_generalization_errors" title="Link to this definition">#</a></dt>
<dd><p>Plot the generalization errors of a model for various metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>metrics</strong> (<em>np.ndarray</em>)  The metrics (e.g., intervals, cutoffs, batch sizes, number of training samples).</p></li>
<li><p><strong>model_errors</strong> (<em>np.ndarray</em>)  The model errors.</p></li>
<li><p><strong>mode</strong> (<em>str</em>)  The mode of generalization (interpolation, extrapolation, sparse, batchsize).</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_gradients_heatmap">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_gradients_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors_log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_correlation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.98</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_gradients_heatmap" title="Link to this definition">#</a></dt>
<dd><p>Plot correlation between gradients (normalized) and dex errors using a heatmap.</p>
<p>Both gradients and errors are in log-space.
Gradients are normalized, errors are absolute log differences (dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Surrogate name.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Config dictionary.</p></li>
<li><p><strong>gradients</strong> (<em>np.ndarray</em>)  Normalized log-space gradients.</p></li>
<li><p><strong>errors_log</strong> (<em>np.ndarray</em>)  dex errors.</p></li>
<li><p><strong>average_correlation</strong> (<em>float</em>)  Mean correlation value.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Save plot.</p></li>
<li><p><strong>cutoff_mass</strong> (<em>float</em>)  Fraction of mass to retain in axes.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Show title.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Histogram stats for reuse.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(max_value, x_max, y_max)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_loss_comparison">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_loss_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_loss_comparison" title="Link to this definition">#</a></dt>
<dd><p>Plot the training and test losses for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_losses</strong> (<em>tuple</em>)  Tuple of training loss arrays for each surrogate model.</p></li>
<li><p><strong>test_losses</strong> (<em>tuple</em>)  Tuple of test loss arrays for each surrogate model.</p></li>
<li><p><strong>labels</strong> (<em>tuple</em>)  Tuple of labels for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_loss_comparison_train_duration">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_loss_comparison_train_duration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_losses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_durations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_loss_comparison_train_duration" title="Link to this definition">#</a></dt>
<dd><p>Plot the test loss trajectories for different surrogate models over training duration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_losses</strong> (<em>tuple</em>)  Tuple of test loss arrays for each surrogate model.</p></li>
<li><p><strong>labels</strong> (<em>tuple</em>)  Tuple of labels for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.#</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_losses">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_histories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Losses'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'main'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_losses" title="Link to this definition">#</a></dt>
<dd><p>Plot the loss trajectories for the training of multiple models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_histories</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">array</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>]</span>)  List of loss history arrays.</p></li>
<li><p><strong>epochs</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>)  Number of epochs.</p></li>
<li><p><strong>labels</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>]</span>)  List of labels for each loss history.</p></li>
<li><p><strong>title</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>)  Title of the plot.</p></li>
<li><p><strong>save</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>)  Whether to save the plot as an image file.</p></li>
<li><p><strong>conf</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]</span>)  The configuration dictionary.</p></li>
<li><p><strong>surr_name</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span>)  The name of the surrogate model.</p></li>
<li><p><strong>mode</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>)  The mode of the training.</p></li>
<li><p><strong>percentage</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>)  Percentage of initial values to exclude from min-max calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
<p>show_title (bool): Whether to show the title on the plot.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_relative_errors">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_relative_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">median_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_relative_errors" title="Link to this definition">#</a></dt>
<dd><p>Plot the relative errors over time for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean_errors</strong> (<em>dict</em>)  Dictionary containing the mean relative errors for each surrogate model.</p></li>
<li><p><strong>median_errors</strong> (<em>dict</em>)  Dictionary containing the median relative errors for each surrogate model.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Array of timesteps.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_surr_losses">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_surr_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_surr_losses" title="Link to this definition">#</a></dt>
<dd><p>Plot the training and test losses for the surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Instance of the surrogate model class.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  The timesteps array.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_uncertainty_confidence">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_uncertainty_confidence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weighted_diffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summary_stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_uncertainty_confidence" title="Link to this definition">#</a></dt>
<dd><p>Plot a comparative grouped bar chart of catastrophic confidence measures and return a metric
quantifying the net skew of over- versus underconfidence.</p>
<dl class="simple">
<dt>For each surrogate model, the target-weighted difference is computed as:</dt><dd><p>weighted_diff = (predicted uncertainty - <a href="#id3"><span class="problematic" id="id4">|prediction - target|</span></a>) / target.</p>
</dd>
</dl>
<p>Negative values indicate overconfidence (i.e. the models uncertainty is too low relative to its error),
while positive values indicate underconfidence.</p>
<p>Catastrophic events are defined as those samples in the lowest <cite>percentile</cite> (e.g. 2nd percentile)
for overconfidence and in the highest <cite>percentile</cite> (i.e. 100 - percentile) for underconfidence.</p>
<p>For each surrogate, this function computes the mean and standard deviation of the weighted
differences in both tails, then plots them as grouped bars (overconfidence bars on the left,
underconfidence bars on the right) with standard error bars (thin, with capsize=3). The bar heights
are expressed in percentages.</p>
<p>The text labels for the bars are placed on the opposite side of the x-axis: for negative (overconfident)
values the annotation is shown a few pixels above the x-axis, and for positive (underconfident) values
it is shown a few pixels below the x-axis.</p>
<p>The plot title includes the metric (mean  std) and the number of samples (per tail).</p>
<p>Additionally, if the range between the smallest and largest bar is more than two orders of magnitude,
the y-axis is set to a symmetric log scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weighted_diffs</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em>)  Dictionary of weighted_diff arrays for each surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot.</p></li>
<li><p><strong>percentile</strong> (<em>float</em><em>, </em><em>optional</em>)  Percentile threshold for defining catastrophic events (default is 2).</p></li>
<li><p><strong>summary_stat</strong> (<em>str</em><em>, </em><em>optional</em>)  Currently only mean is implemented.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping surrogate names to the net difference (over_summary + under_summary).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[str, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_uncertainty_heatmap">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_uncertainty_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_correlation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.98</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_uncertainty_heatmap" title="Link to this definition">#</a></dt>
<dd><p>Plot correlation between predictive log-space uncertainty and log-space errors (delta dex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  Name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>preds_std</strong> (<em>np.ndarray</em>)  Log-space ensemble standard deviation.</p></li>
<li><p><strong>errors</strong> (<em>np.ndarray</em>)  Log-space prediction errors.</p></li>
<li><p><strong>average_correlation</strong> (<em>float</em>)  Correlation between log uncertainty and log error.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the figure.</p></li>
<li><p><strong>cutoff_mass</strong> (<em>float</em>)  Fraction of mass to keep in histogram.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show a title.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(max histogram count, axis_max used for plotting).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_uncertainty_over_time_comparison">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_uncertainty_over_time_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uncertainties</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absolute_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_uncertainty_over_time_comparison" title="Link to this definition">#</a></dt>
<dd><p>Plot log-space uncertainty and dex over time for multiple surrogates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uncertainties</strong> (<em>dict</em>)  Mean log-space std over time per surrogate (1 time series).</p></li>
<li><p><strong>absolute_errors</strong> (<em>dict</em>)  dex arrays [N, T, Q] per surrogate.</p></li>
<li><p><strong>timesteps</strong> (<em>np.ndarray</em>)  Timesteps array.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Save figure.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Add title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.plot_uncertainty_vs_errors">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">plot_uncertainty_vs_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.plot_uncertainty_vs_errors" title="Link to this definition">#</a></dt>
<dd><p>Plot the correlation between predictive uncertainty and prediction errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>preds_std</strong> (<em>np.ndarray</em>)  Standard deviation of predictions from the ensemble of models.</p></li>
<li><p><strong>errors</strong> (<em>np.ndarray</em>)  Prediction errors.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to save the plot as a file.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.read_yaml_config">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">read_yaml_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.read_yaml_config" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.rel_errors_and_uq">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">rel_errors_and_uq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.rel_errors_and_uq" title="Link to this definition">#</a></dt>
<dd><p>Create a figure with two subplots: relative errors over time and uncertainty over time for different surrogate models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>dict</em>)  Dictionary containing the benchmark metrics for each surrogate model.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary.</p></li>
<li><p><strong>save</strong> (<em>bool</em>)  Whether to save the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em>)  Whether to show the title on the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.run_benchmark">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">run_benchmark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surrogate_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.run_benchmark" title="Link to this definition">#</a></dt>
<dd><p>Run benchmarks for a given surrogate model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model to benchmark.</p></li>
<li><p><strong>surrogate_class</strong>  The class of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing all relevant metrics for the given model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.save_plot">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">save_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plots'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increase_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jpg'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.save_plot" title="Link to this definition">#</a></dt>
<dd><p>Save the plot to a file, creating necessary directories if they dont exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plt</strong> (<em>matplotlib.pyplot</em>)  The plot object to save.</p></li>
<li><p><strong>filename</strong> (<em>str</em>)  The desired filename for the plot.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>dpi</strong> (<em>int</em>)  The resolution of the saved plot.</p></li>
<li><p><strong>base_dir</strong> (<em>str</em><em>, </em><em>optional</em>)  The base directory where plots will be saved. Default is plots.</p></li>
<li><p><strong>increase_count</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to increment the filename count if a file already exists. Default is True.</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>)  The format for saving the plot. Default is png. Can be png, pdf, svg, etc.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong>  If the configuration dictionary does not contain the required keys.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.save_plot_counter">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">save_plot_counter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increase_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.save_plot_counter" title="Link to this definition">#</a></dt>
<dd><p>Save a plot with an incremented filename if a file with the same name already exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>)  The desired filename for the plot.</p></li>
<li><p><strong>directory</strong> (<em>str</em>)  The directory to save the plot in.</p></li>
<li><p><strong>increase_count</strong> (<em>bool</em><em>, </em><em>optional</em>)  Whether to increment the filename count if a file already exists. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The full path to the saved plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.save_table_csv">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">save_table_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">headers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.save_table_csv" title="Link to this definition">#</a></dt>
<dd><p>Save the CLI table (headers and rows) to a CSV file.
This version strips out any formatting (like asterisks) from the table cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>headers</strong> (<em>list</em>)  The list of header names.</p></li>
<li><p><strong>rows</strong> (<em>list</em>)  The list of rows, where each row is a list of string values.</p></li>
<li><p><strong>config</strong> (<em>dict</em>)  Configuration dictionary that contains training_id.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.tabular_comparison">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">tabular_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.tabular_comparison" title="Link to this definition">#</a></dt>
<dd><p>Compare the metrics of different surrogate models in a tabular format.
Prints a table to the CLI, saves the table into a text file, and saves a CSV file with all metrics.
Also saves a CSV file with only the metrics that appear in the CLI table.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.time_inference">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">time_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_test_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_runs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.time_inference" title="Link to this definition">#</a></dt>
<dd><p>Time the inference of the surrogate model (full version with metrics).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong>  Instance of the surrogate model class.</p></li>
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>)  The DataLoader object containing the test data.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>n_test_samples</strong> (<em>int</em>)  The number of test samples.</p></li>
<li><p><strong>n_runs</strong> (<em>int</em><em>, </em><em>optional</em>)  Number of times to run the inference for timing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing timing metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="codes.benchmark.write_metrics_to_yaml">
<span class="sig-prename descclassname"><span class="pre">codes.benchmark.</span></span><span class="sig-name descname"><span class="pre">write_metrics_to_yaml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surr_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#codes.benchmark.write_metrics_to_yaml" title="Link to this definition">#</a></dt>
<dd><p>Write the benchmark metrics to a YAML file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surr_name</strong> (<em>str</em>)  The name of the surrogate model.</p></li>
<li><p><strong>conf</strong> (<em>dict</em>)  The configuration dictionary.</p></li>
<li><p><strong>metrics</strong> (<em>dict</em>)  The benchmark metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-codes.benchmark.bench_fcts">codes.benchmark.bench_fcts module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_UQ"><code class="docutils literal notranslate"><span class="pre">compare_UQ()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_batchsize"><code class="docutils literal notranslate"><span class="pre">compare_batchsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_errors"><code class="docutils literal notranslate"><span class="pre">compare_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_extrapolation"><code class="docutils literal notranslate"><span class="pre">compare_extrapolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_gradients"><code class="docutils literal notranslate"><span class="pre">compare_gradients()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_inference_time"><code class="docutils literal notranslate"><span class="pre">compare_inference_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_interpolation"><code class="docutils literal notranslate"><span class="pre">compare_interpolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_main_losses"><code class="docutils literal notranslate"><span class="pre">compare_main_losses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_models"><code class="docutils literal notranslate"><span class="pre">compare_models()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.compare_sparse"><code class="docutils literal notranslate"><span class="pre">compare_sparse()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_UQ"><code class="docutils literal notranslate"><span class="pre">evaluate_UQ()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_accuracy"><code class="docutils literal notranslate"><span class="pre">evaluate_accuracy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_batchsize"><code class="docutils literal notranslate"><span class="pre">evaluate_batchsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_compute"><code class="docutils literal notranslate"><span class="pre">evaluate_compute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_extrapolation"><code class="docutils literal notranslate"><span class="pre">evaluate_extrapolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_gradients"><code class="docutils literal notranslate"><span class="pre">evaluate_gradients()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_interpolation"><code class="docutils literal notranslate"><span class="pre">evaluate_interpolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_iterative_predictions"><code class="docutils literal notranslate"><span class="pre">evaluate_iterative_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.evaluate_sparse"><code class="docutils literal notranslate"><span class="pre">evaluate_sparse()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.run_benchmark"><code class="docutils literal notranslate"><span class="pre">run_benchmark()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.tabular_comparison"><code class="docutils literal notranslate"><span class="pre">tabular_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_fcts.time_inference"><code class="docutils literal notranslate"><span class="pre">time_inference()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-codes.benchmark.bench_plots">codes.benchmark.bench_plots module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.get_custom_palette"><code class="docutils literal notranslate"><span class="pre">get_custom_palette()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.inference_time_bar_plot"><code class="docutils literal notranslate"><span class="pre">inference_time_bar_plot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_MAE_comparison"><code class="docutils literal notranslate"><span class="pre">plot_MAE_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_all_generalization_errors"><code class="docutils literal notranslate"><span class="pre">plot_all_generalization_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_average_errors_over_time"><code class="docutils literal notranslate"><span class="pre">plot_average_errors_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_average_uncertainty_over_time"><code class="docutils literal notranslate"><span class="pre">plot_average_uncertainty_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_catastrophic_detection_curves"><code class="docutils literal notranslate"><span class="pre">plot_catastrophic_detection_curves()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_comparative_error_correlation_heatmaps"><code class="docutils literal notranslate"><span class="pre">plot_comparative_error_correlation_heatmaps()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_comparative_gradient_heatmaps"><code class="docutils literal notranslate"><span class="pre">plot_comparative_gradient_heatmaps()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_dynamic_correlation"><code class="docutils literal notranslate"><span class="pre">plot_dynamic_correlation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_error_distribution_comparative"><code class="docutils literal notranslate"><span class="pre">plot_error_distribution_comparative()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_error_distribution_per_quantity"><code class="docutils literal notranslate"><span class="pre">plot_error_distribution_per_quantity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_error_percentiles_over_time"><code class="docutils literal notranslate"><span class="pre">plot_error_percentiles_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_errors_over_time"><code class="docutils literal notranslate"><span class="pre">plot_errors_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_example_iterative_predictions"><code class="docutils literal notranslate"><span class="pre">plot_example_iterative_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_example_mode_predictions"><code class="docutils literal notranslate"><span class="pre">plot_example_mode_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_example_predictions_with_uncertainty"><code class="docutils literal notranslate"><span class="pre">plot_example_predictions_with_uncertainty()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_generalization_error_comparison"><code class="docutils literal notranslate"><span class="pre">plot_generalization_error_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_generalization_errors"><code class="docutils literal notranslate"><span class="pre">plot_generalization_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_gradients_heatmap"><code class="docutils literal notranslate"><span class="pre">plot_gradients_heatmap()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_loss_comparison"><code class="docutils literal notranslate"><span class="pre">plot_loss_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_loss_comparison_equal"><code class="docutils literal notranslate"><span class="pre">plot_loss_comparison_equal()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_loss_comparison_train_duration"><code class="docutils literal notranslate"><span class="pre">plot_loss_comparison_train_duration()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_losses"><code class="docutils literal notranslate"><span class="pre">plot_losses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_losses_dual_axis"><code class="docutils literal notranslate"><span class="pre">plot_losses_dual_axis()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_mean_deltadex_over_time_main_vs_ensemble"><code class="docutils literal notranslate"><span class="pre">plot_mean_deltadex_over_time_main_vs_ensemble()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_relative_errors"><code class="docutils literal notranslate"><span class="pre">plot_relative_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_surr_losses"><code class="docutils literal notranslate"><span class="pre">plot_surr_losses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_uncertainty_confidence"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_confidence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_uncertainty_heatmap"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_heatmap()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_uncertainty_over_time_comparison"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_over_time_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.plot_uncertainty_vs_errors"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_vs_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.rel_errors_and_uq"><code class="docutils literal notranslate"><span class="pre">rel_errors_and_uq()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.save_plot"><code class="docutils literal notranslate"><span class="pre">save_plot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_plots.save_plot_counter"><code class="docutils literal notranslate"><span class="pre">save_plot_counter()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-codes.benchmark.bench_utils">codes.benchmark.bench_utils module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.check_benchmark"><code class="docutils literal notranslate"><span class="pre">check_benchmark()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.check_surrogate"><code class="docutils literal notranslate"><span class="pre">check_surrogate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.clean_metrics"><code class="docutils literal notranslate"><span class="pre">clean_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.convert_dict_to_scientific_notation"><code class="docutils literal notranslate"><span class="pre">convert_dict_to_scientific_notation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.convert_to_standard_types"><code class="docutils literal notranslate"><span class="pre">convert_to_standard_types()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.count_trainable_parameters"><code class="docutils literal notranslate"><span class="pre">count_trainable_parameters()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.discard_numpy_entries"><code class="docutils literal notranslate"><span class="pre">discard_numpy_entries()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.flatten_dict"><code class="docutils literal notranslate"><span class="pre">flatten_dict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.format_seconds"><code class="docutils literal notranslate"><span class="pre">format_seconds()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.format_time"><code class="docutils literal notranslate"><span class="pre">format_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.format_value"><code class="docutils literal notranslate"><span class="pre">format_value()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.get_model_config"><code class="docutils literal notranslate"><span class="pre">get_model_config()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.get_required_models_list"><code class="docutils literal notranslate"><span class="pre">get_required_models_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.get_surrogate"><code class="docutils literal notranslate"><span class="pre">get_surrogate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.load_model"><code class="docutils literal notranslate"><span class="pre">load_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.make_comparison_csv"><code class="docutils literal notranslate"><span class="pre">make_comparison_csv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.measure_inference_time"><code class="docutils literal notranslate"><span class="pre">measure_inference_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.measure_memory_footprint"><code class="docutils literal notranslate"><span class="pre">measure_memory_footprint()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.save_table_csv"><code class="docutils literal notranslate"><span class="pre">save_table_csv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.bench_utils.write_metrics_to_yaml"><code class="docutils literal notranslate"><span class="pre">write_metrics_to_yaml()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-codes.benchmark">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.check_benchmark"><code class="docutils literal notranslate"><span class="pre">check_benchmark()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.check_surrogate"><code class="docutils literal notranslate"><span class="pre">check_surrogate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.clean_metrics"><code class="docutils literal notranslate"><span class="pre">clean_metrics()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_UQ"><code class="docutils literal notranslate"><span class="pre">compare_UQ()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_batchsize"><code class="docutils literal notranslate"><span class="pre">compare_batchsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_errors"><code class="docutils literal notranslate"><span class="pre">compare_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_extrapolation"><code class="docutils literal notranslate"><span class="pre">compare_extrapolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_gradients"><code class="docutils literal notranslate"><span class="pre">compare_gradients()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_inference_time"><code class="docutils literal notranslate"><span class="pre">compare_inference_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_interpolation"><code class="docutils literal notranslate"><span class="pre">compare_interpolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_main_losses"><code class="docutils literal notranslate"><span class="pre">compare_main_losses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_models"><code class="docutils literal notranslate"><span class="pre">compare_models()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.compare_sparse"><code class="docutils literal notranslate"><span class="pre">compare_sparse()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.convert_dict_to_scientific_notation"><code class="docutils literal notranslate"><span class="pre">convert_dict_to_scientific_notation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.convert_to_standard_types"><code class="docutils literal notranslate"><span class="pre">convert_to_standard_types()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.count_trainable_parameters"><code class="docutils literal notranslate"><span class="pre">count_trainable_parameters()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.discard_numpy_entries"><code class="docutils literal notranslate"><span class="pre">discard_numpy_entries()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_UQ"><code class="docutils literal notranslate"><span class="pre">evaluate_UQ()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_accuracy"><code class="docutils literal notranslate"><span class="pre">evaluate_accuracy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_batchsize"><code class="docutils literal notranslate"><span class="pre">evaluate_batchsize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_compute"><code class="docutils literal notranslate"><span class="pre">evaluate_compute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_extrapolation"><code class="docutils literal notranslate"><span class="pre">evaluate_extrapolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_gradients"><code class="docutils literal notranslate"><span class="pre">evaluate_gradients()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_interpolation"><code class="docutils literal notranslate"><span class="pre">evaluate_interpolation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.evaluate_sparse"><code class="docutils literal notranslate"><span class="pre">evaluate_sparse()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.flatten_dict"><code class="docutils literal notranslate"><span class="pre">flatten_dict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.format_seconds"><code class="docutils literal notranslate"><span class="pre">format_seconds()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.format_time"><code class="docutils literal notranslate"><span class="pre">format_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.format_value"><code class="docutils literal notranslate"><span class="pre">format_value()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.get_custom_palette"><code class="docutils literal notranslate"><span class="pre">get_custom_palette()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.get_model_config"><code class="docutils literal notranslate"><span class="pre">get_model_config()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.get_required_models_list"><code class="docutils literal notranslate"><span class="pre">get_required_models_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.get_surrogate"><code class="docutils literal notranslate"><span class="pre">get_surrogate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.inference_time_bar_plot"><code class="docutils literal notranslate"><span class="pre">inference_time_bar_plot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.load_model"><code class="docutils literal notranslate"><span class="pre">load_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.make_comparison_csv"><code class="docutils literal notranslate"><span class="pre">make_comparison_csv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.measure_inference_time"><code class="docutils literal notranslate"><span class="pre">measure_inference_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.measure_memory_footprint"><code class="docutils literal notranslate"><span class="pre">measure_memory_footprint()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_MAE_comparison"><code class="docutils literal notranslate"><span class="pre">plot_MAE_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_all_generalization_errors"><code class="docutils literal notranslate"><span class="pre">plot_all_generalization_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_average_errors_over_time"><code class="docutils literal notranslate"><span class="pre">plot_average_errors_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_average_uncertainty_over_time"><code class="docutils literal notranslate"><span class="pre">plot_average_uncertainty_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_comparative_error_correlation_heatmaps"><code class="docutils literal notranslate"><span class="pre">plot_comparative_error_correlation_heatmaps()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_comparative_gradient_heatmaps"><code class="docutils literal notranslate"><span class="pre">plot_comparative_gradient_heatmaps()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_dynamic_correlation"><code class="docutils literal notranslate"><span class="pre">plot_dynamic_correlation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_error_distribution_comparative"><code class="docutils literal notranslate"><span class="pre">plot_error_distribution_comparative()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_error_distribution_per_quantity"><code class="docutils literal notranslate"><span class="pre">plot_error_distribution_per_quantity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_error_percentiles_over_time"><code class="docutils literal notranslate"><span class="pre">plot_error_percentiles_over_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_example_iterative_predictions"><code class="docutils literal notranslate"><span class="pre">plot_example_iterative_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_example_mode_predictions"><code class="docutils literal notranslate"><span class="pre">plot_example_mode_predictions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_example_predictions_with_uncertainty"><code class="docutils literal notranslate"><span class="pre">plot_example_predictions_with_uncertainty()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_generalization_error_comparison"><code class="docutils literal notranslate"><span class="pre">plot_generalization_error_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_generalization_errors"><code class="docutils literal notranslate"><span class="pre">plot_generalization_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_gradients_heatmap"><code class="docutils literal notranslate"><span class="pre">plot_gradients_heatmap()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_loss_comparison"><code class="docutils literal notranslate"><span class="pre">plot_loss_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_loss_comparison_train_duration"><code class="docutils literal notranslate"><span class="pre">plot_loss_comparison_train_duration()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_losses"><code class="docutils literal notranslate"><span class="pre">plot_losses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_relative_errors"><code class="docutils literal notranslate"><span class="pre">plot_relative_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_surr_losses"><code class="docutils literal notranslate"><span class="pre">plot_surr_losses()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_uncertainty_confidence"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_confidence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_uncertainty_heatmap"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_heatmap()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_uncertainty_over_time_comparison"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_over_time_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.plot_uncertainty_vs_errors"><code class="docutils literal notranslate"><span class="pre">plot_uncertainty_vs_errors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.read_yaml_config"><code class="docutils literal notranslate"><span class="pre">read_yaml_config()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.rel_errors_and_uq"><code class="docutils literal notranslate"><span class="pre">rel_errors_and_uq()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.run_benchmark"><code class="docutils literal notranslate"><span class="pre">run_benchmark()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.save_plot"><code class="docutils literal notranslate"><span class="pre">save_plot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.save_plot_counter"><code class="docutils literal notranslate"><span class="pre">save_plot_counter()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.save_table_csv"><code class="docutils literal notranslate"><span class="pre">save_table_csv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.tabular_comparison"><code class="docutils literal notranslate"><span class="pre">tabular_comparison()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.time_inference"><code class="docutils literal notranslate"><span class="pre">time_inference()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codes.benchmark.write_metrics_to_yaml"><code class="docutils literal notranslate"><span class="pre">write_metrics_to_yaml()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Robin Janssen, Immanuel Sulzer
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2024, Robin Janssen, Immanuel Sulzer.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>